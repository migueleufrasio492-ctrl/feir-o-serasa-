try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{})["__faroBundleId_gptengineer-app"]="1764098497929708c08cf4c"}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8729],{3140:(e,t,r)=>{"use strict";r.d(t,{M:()=>g,s:()=>h});var a=r(77145),n=r(98251),i=r(13410),s=r(95661),o=r(19620),l=r(15822),c=r(40702);let u=null,d="30uiF44drV1UnRmUEUVhfQ2L500",m="https://rs.lovable.dev",p=d&&m;d&&m||o.logging.info("Missing NEXT_PUBLIC_RUDDERSTACK_WRITE_KEY or NEXT_PUBLIC_RUDDERSTACK_DATA_PLANE_URL in env; RudderStack will be disabled");let f=(0,s.createContext)(null);function h(e){let{children:t}=e,[r]=(0,s.useState)(()=>!p||l.W?null:(u||(o.logging.log("Initializing RudderStack Analytics"),(u=new n.p).load(d,m,{integrations:{All:!0},configUrl:"https://rs.lovable.dev/sourceConfig",destSDKBaseURL:"https://rs.lovable.dev/v3/modern/js-integrations"})),u)),{authUser:h}=(0,c.Z2)(),g=(0,c.Nm)(),v=(0,i.usePathname)();return(0,s.useEffect)(()=>{r&&((null==h?void 0:h.uid)?(o.logging.debug("RudderStack: Identifying user",{userId:h.uid}),r.identify(h.uid,{email:g,name:h.displayName})):(o.logging.debug("RudderStack: Resetting user session"),r.reset()))},[null==h?void 0:h.uid,g,null==h?void 0:h.displayName,r]),(0,s.useEffect)(()=>{r&&r.page()},[v,r]),(0,a.jsx)(f.Provider,{value:r,children:t})}function g(){return(0,s.useContext)(f)}},3164:(e,t,r)=>{var a=r(47188),n=r(66700);e.exports=function(e){return n(e)&&"[object Arguments]"==a(e)}},3397:(e,t,r)=>{e=r.nmd(e);var a=r(62996),n=t&&!t.nodeType&&t,i=n&&e&&!e.nodeType&&e,s=i&&i.exports===n&&a.process,o=function(){try{var e=i&&i.require&&i.require("util").types;if(e)return e;return s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=o},4269:(e,t,r)=>{var a=r(62996),n="object"==typeof self&&self&&self.Object===Object&&self;e.exports=a||n||Function("return this")()},6592:(e,t,r)=>{var a=r(23555);e.exports=function(e,t){var r=-1,n=e.length,i=n-1;for(t=void 0===t?n:t;++r<t;){var s=a(r,i),o=e[s];e[s]=e[r],e[r]=o}return e.length=t,e}},7065:(e,t,r)=>{e.exports=r(4269).Symbol},11070:(e,t,r)=>{"use strict";r.d(t,{K:()=>g,N:()=>v});var a=r(92912),n=r(75222),i=r(63851),s=r(19620),o=r(72632),l=r(51573),c=r(69850),u=r(62548),d=r(74507),m=r(83473),p=r(39528),f=r(32736);let h=async(e,t,r)=>{try{let n=(0,i.P)();await n.post("/workspaces/".concat(e,"/campaigns/").concat(t,"/redeem/").concat(r)),a.Ay.capture(p.yx.REWARD.REDEEMED,{campaign:t,reward_code:r,workspace_id:e});return}catch(i){let n;throw s.logging.error("Failed to redeem campaign reward",{error:i,workspaceId:e,campaignName:t,rewardCode:r}),n=i instanceof Error?i:Error("Unknown error occurred while redeeming reward",{cause:i}),a.Ay.capture(p.yx.REWARD.REDEEM_FAILED,{campaign:t,reward_code:r,workspace_id:e,error_message:n.message}),n}},g={key:f.A.CLAIM_REWARD,paramsSchema:n.Ik({campaignId:n.Yj().regex(/^[a-zA-Z0-9-]+$/),rewardCode:n.Yj().regex(/^[a-zA-Z0-9-]+$/)}),execute:async(e,t)=>{let{campaignId:r,rewardCode:a}=e,{workspaces:n,selectedWorkspaceId:i}=t,s=i;return(!s&&n&&n.length>0&&(s=(e=>{if(1===e.length){let t=e[0],{isPaidPlan:r}=(0,o.cb)(t.plan);if(!r)return t.id}return null})(n)),s)?(await h(s,r,a),{redirectUrl:"/?change_type=upgrade&payment_status=success",invalidateQueries:[c.workspaceKeys.all],workspaceUpdate:{workspaceId:s,updates:{plan:l.VL.KTLO}}}):{redirectUrl:"/lp/".concat(r,"?reward_code=").concat(a)}}},v={key:f.A.REMIX_PROJECT,paramsSchema:n.Ik({projectId:n.Yj().regex(/^[a-zA-Z0-9_-]+$/),initialMessage:n.Ik({id:n.Yj(),message:n.Yj(),files:n.YO(n.Ik({file_id:n.Yj(),type:n.fc(u.g),file_name:n.Yj().optional(),mime_type:n.Yj().optional()})).optional(),selected_elements:n.YO(n.bz()).length(0),chat_only:n.zM().optional()}).optional()}),execute:async(e,t)=>{let{projectId:r}=e,{workspaces:a,selectedWorkspaceId:n}=t;try{var o;let t,l=(0,i.P)(),u=0;for(;u<3;)try{t=await l.get("/permissions?projectId=".concat(r));break}catch(e){if(++u>=3)return s.logging.error("Failed to fetch permissions after retries",{error:e,projectId:r,retries:u}),{redirectUrl:"/projects/".concat(r)};await new Promise(e=>setTimeout(e,1e3*u))}let m=t.includes(d.eZ.EditProject),p=t.includes(d.eZ.RemixProject);if(m)return{redirectUrl:"/projects/".concat(r)};if(!p)return{redirectUrl:"/"};let f=n||(null==a||null==(o=a[0])?void 0:o.id);if(!f)return s.logging.error("No workspace available for remix",{projectId:r}),{redirectUrl:"/"};let h=await l.get("/projects/".concat(r,"/details")),g=h.display_name||h.name||r,v={include_history:!1,include_custom_knowledge:!1,workspace_id:f,initial_message:e.initialMessage},y=await l.post("/projects/".concat(r,"/remix/init"),v);return localStorage.setItem("pendingRemixJob",JSON.stringify({jobId:y.job_id,projectId:r,projectName:g,timestamp:Date.now()})),{redirectUrl:"/",invalidateQueries:[c.gO.all]}}catch(e){return s.logging.error("Failed to execute remix project action",{error:e,projectId:r}),(0,m.Ni)(e),{redirectUrl:"/projects/".concat(r)}}}}},14618:(e,t,r)=>{"use strict";r.d(t,{l:()=>i});var a=r(95661),n=r(65616);let i=()=>({upload:(0,a.useCallback)(async e=>{let{fileName:t,file:r,options:a,continueOnError:i=!0}=e;return(0,n.QM)(t,r,a,i)},[]),download:(0,a.useCallback)(async e=>(0,n.PE)(e),[])})},15177:(e,t,r)=>{var a=r(47188),n=r(82704),i=r(66700),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&n(e.length)&&!!s[a(e)]}},15822:(e,t,r)=>{"use strict";r.d(t,{W:()=>n});let a="undefined"!=typeof navigator,n=a&&!0===navigator.webdriver||a&&navigator.userAgent.includes("HeadlessChrome")},16169:(e,t,r)=>{var a=r(15177),n=r(59515),i=r(3397),s=i&&i.isTypedArray;e.exports=s?n(s):a},16274:(e,t,r)=>{e=r.nmd(e);var a=r(4269),n=r(74131),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,o=s&&s.exports===i?a.Buffer:void 0,l=o?o.isBuffer:void 0;e.exports=l||n},16838:(e,t,r)=>{Promise.resolve().then(r.bind(r,82862))},19951:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var a=typeof e;return!!(r=null==r?0x1fffffffffffff:r)&&("number"==a||"symbol"!=a&&t.test(e))&&e>-1&&e%1==0&&e<r}},21166:(e,t,r)=>{var a=r(91632),n=r(82704);e.exports=function(e){return null!=e&&n(e.length)&&!a(e)}},22283:(e,t,r)=>{var a=r(63185),n=r(6592);e.exports=function(e){return n(a(e))}},23555:e=>{var t=Math.floor,r=Math.random;e.exports=function(e,a){return e+t(r()*(a-e+1))}},25249:(e,t,r)=>{"use strict";r.d(t,{N:()=>F,U:()=>R});var a=r(77145),n=r(9898),i=r(18502),s=r(87299),o=r(6698),l=r(52037),c=r(31088),u=r(75222),d=r(40702),m=r(61374),p=r(49493),f=r(57841),h=r(94123),g=r(73893),v=r(26158),y=r(52811),x=r(19695),b=r(20247),j=r(27549),w=r(69730),k=r(6397),N=r(32313),S=r(83473),E=r(63851),C=r(680),I=r(214),A=r(72632),_=r(99989),T=r(74507),M=r(13410),O=r(83220),P=r(54994),U=r(69850),L=r(30425);let D=u.Ik({name:u.Yj().min(1,"Workspace name is required").max(100,"Workspace name must be 100 characters or less").trim(),description:u.Yj().max(500,"Description must be 500 characters or less").optional().or(u.eu("")),defaultMonthlyMemberCreditLimit:u.KC([u.ai().positive("Credit limit must be a positive number").max(1e6,"Credit limit must be less than 1,000,000"),u.ch(),u.Vx()]).optional()}),F=e=>{var t,r,s,u;let{workspace:p,membership:F}=e,{EditWorkspaceSettings:$,LeaveWorkspace:W}=T.eZ,{SetCreditLimit:V}=C.x,{data:K,isLoading:z}=(0,i.I)({..._.y.searchWorkspaceMemberships({workspaceId:p.id,params:{query:"",status:"active",roles:["owner"],limit:2}}),enabled:!!p.id&&(null==F?void 0:F.role)==="owner"}),B=null!=(t=null==K?void 0:K.total)?t:1,Y=(null==F?void 0:F.role)==="owner",J=Y&&(z||B<=1),{permitted:q}=(0,m.J)($),G=(0,l.mN)({defaultValues:{name:null!=(r=p.name)?r:"",description:null!=(s=p.description)?s:"",defaultMonthlyMemberCreditLimit:null!=(u=p.default_monthly_member_credit_limit)?u:void 0},resolver:(0,n.u)(D)}),{leaveWorkspace:Q,isLeavingWorkspace:Z}=function(){let{setCurrentWorkspaceId:e}=(0,O.Dx)(),{authUser:t}=(0,d.Z2)(),r=(0,M.useRouter)(),{mutateAsync:a,isPending:n}=(0,o.n)({mutationFn:async e=>(0,E.P)().post("/user/workspaces/".concat(e,"/leave")),onSuccess:async()=>{e(null),r.push("/"),c.toast.success("Workspace left successfully",{description:"Automatically switching your selected workspace"})},onError:e=>{(0,S.Ni)(e)},onSettled:()=>{var e;P.queryClient.invalidateQueries({queryKey:U.workspaceKeys.workspaces({userId:null!=(e=null==t?void 0:t.uid)?e:""})})}});return{leaveWorkspace:a,isLeavingWorkspace:n}}(),{updateWorkspace:H,isUpdatingWorkspace:X}=R({form:G,workspaceId:p.id}),{isBizPlan:ee}=(0,A.cb)(p.plan),et=(0,I.ZS)();return(0,a.jsx)(v.Pt,{title:"Workspace settings",value:"workspace",description:"Workspaces allow you to collaborate on projects in real time.",docsLink:"https://docs.lovable.dev/user-guides/teams",children:(0,a.jsx)(j.lV,{...G,children:(0,a.jsxs)("form",{className:"flex w-full flex-col gap-6",onSubmit:G.handleSubmit(e=>{H(e)}),children:[(0,a.jsx)(g.m,{label:"Workspace Avatar",description:"Set an avatar for your workspace.",mobileLayout:"horizontal",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f.z,{className:"h-10 w-10",workspace:p}),(0,a.jsx)(h.E,{permission:$,children:(0,a.jsx)(L.w,{workspace:p})})]})}),(0,a.jsx)(g.m,{label:"Workspace Name",description:"Your full workspace name, as visible to others.",children:(0,a.jsx)(j.zB,{control:G.control,name:"name",render:e=>{var t,r;let{field:n}=e;return(0,a.jsxs)(j.eI,{className:"w-full",children:[(0,a.jsx)(j.MJ,{children:(0,a.jsx)(x.Q,{showTooltip:!q,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(k.p,{...n,placeholder:"Enter workspace name",disabled:!q,maxLength:100})})}),(0,a.jsxs)("div",{className:"flex justify-end text-xs text-muted-foreground",children:[null!=(r=null==(t=n.value)?void 0:t.length)?r:0," / 100 characters"]}),(0,a.jsx)(j.C5,{})]})}})}),(0,a.jsx)(g.m,{label:"Workspace Description",description:"A short description about your workspace or team.",isLast:!et&&q&&!ee,children:(0,a.jsx)(j.zB,{control:G.control,name:"description",render:e=>{var t,r;let{field:n}=e;return(0,a.jsxs)(j.eI,{className:"w-full",children:[(0,a.jsx)(j.MJ,{children:(0,a.jsx)(x.Q,{showTooltip:!q,tooltipContent:"You need to be a workspace admin to modify this field",children:(0,a.jsx)(N.T,{rows:3,className:"border bg-background",placeholder:"Description",disabled:!q,maxLength:500,...n})})}),(0,a.jsxs)("div",{className:"flex justify-end text-xs text-muted-foreground",children:[null!=(r=null==(t=n.value)?void 0:t.length)?r:0," / 500 characters"]}),(0,a.jsx)(j.C5,{})]})}})}),(0,a.jsx)(h.E,{permission:$,featureFlags:[V],children:(0,a.jsx)(g.m,{label:"Default Monthly Member Credit Limit",description:"The default monthly credit limit for members of this workspace. Leave empty to use no limit.",children:(0,a.jsx)(j.zB,{control:G.control,name:"defaultMonthlyMemberCreditLimit",render:e=>{var t,r;let{field:n}=e;return(0,a.jsxs)(j.eI,{className:"w-full",children:[(0,a.jsx)(j.MJ,{children:(0,a.jsx)(k.p,{...n,type:"number",placeholder:"Enter default monthly member credit limit (optional)",disabled:!q,onChange:e=>{let t=e.target.value;if(""===t)n.onChange(null),G.setValue("defaultMonthlyMemberCreditLimit",null,{shouldDirty:!0});else{let e=Number(t);!isNaN(e)&&e>0&&n.onChange(e)}},onBlur:n.onBlur,name:n.name,value:null===n.value?"":null!=(r=null==(t=n.value)?void 0:t.toString())?r:""})}),(0,a.jsx)(j.C5,{})]})}})})}),(0,a.jsx)(h.E,{permission:W,children:(0,a.jsx)(g.m,{label:"Leave Workspace",description:z?"Checking ownership status...":J?"You cannot leave as you are the only owner. Please transfer ownership first.":Y&&B>1?"Leave the workspace. There are other owners who will maintain access.":"Leave the workspace (you will lose all access to projects inside this workspace).",isLast:!0,justify:"end",className:J?"opacity-50":"",mobileLayout:"horizontal",children:(0,a.jsx)("div",{className:"flex items-center justify-end gap-2",children:z?(0,a.jsxs)(y.$,{variant:"destructive",type:"button",disabled:!0,children:[(0,a.jsx)(w.A,{name:"refresh",className:"mr-2 h-4 w-4 animate-spin"}),"Loading..."]}):J?(0,a.jsx)("div",{className:"cursor-not-allowed",children:(0,a.jsx)(y.$,{variant:"destructive",type:"button",disabled:!0,className:"pointer-events-none",children:"Leave Workspace"})}):(0,a.jsxs)(b.lG,{children:[(0,a.jsx)(b.zM,{asChild:!0,children:(0,a.jsx)(y.$,{variant:"destructive",type:"button",loading:Z,children:"Leave Workspace"})}),(0,a.jsxs)(b.Cf,{size:"sm",children:[(0,a.jsxs)(b.c7,{children:[(0,a.jsx)(b.L3,{children:"Leave Workspace"}),(0,a.jsx)(b.rr,{children:Y&&B>1?"Are you sure you want to leave this workspace? There are other owners who will maintain access.":"Are you sure you want to leave this workspace?"})]}),(0,a.jsxs)(b.Es,{children:[(0,a.jsx)(b.HM,{asChild:!0,children:(0,a.jsx)(y.$,{variant:"outline",children:"Cancel"})}),(0,a.jsx)(y.$,{variant:"destructive",type:"button",loading:Z,onClick:()=>Q(p.id),children:"Leave Workspace"})]})]})]})})})}),G.formState.isDirty&&(0,a.jsx)(g.E,{children:(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,a.jsx)(y.$,{variant:"secondary",type:"button",onClick:()=>{G.reset()},children:"Cancel"}),(0,a.jsx)(y.$,{variant:"affirmative",type:"submit",loading:X,children:"Update"})]})})]})})})};function R(e){let{form:t,workspaceId:r,quietSuccess:a=!1}=e,n=(0,s.jE)(),{authUser:i}=(0,d.Z2)(),{store:l}=(0,p.k9)(),{mutate:u,isPending:m}=(0,o.n)({mutationFn:async e=>{var t;return(0,E.P)().put("/user/workspaces/".concat(r),{name:e.name,description:null!=(t=e.description)?t:"",...void 0!==e.defaultMonthlyMemberCreditLimit&&{default_monthly_member_credit_limit:null===e.defaultMonthlyMemberCreditLimit?-1:e.defaultMonthlyMemberCreditLimit}})},onSuccess:e=>{var s,o,u,d;a||c.toast.success("Success",{description:"Workspace settings updated successfully"});let m=_.y.detail({workspaceId:r,projectId:void 0}).queryKey;n.setQueryData(m,t=>t?{...t,workspace:e}:{workspace:e,projects:[],is_member:!0,current_member:null});let p=_.y.workspaces({userId:null==i?void 0:i.uid}).queryKey;n.setQueryData(p,t=>t?{workspaces:t.workspaces.map(t=>t.id===e.id?e:t)}:{workspaces:[e]});let f=(null!=(s=null==l?void 0:l.getState().workspaces)?s:[]).map(t=>t.id===e.id?e:t);null==l||l.setState({workspaces:f}),t.reset({name:null!=(o=e.name)?o:"",description:null!=(u=e.description)?u:"",defaultMonthlyMemberCreditLimit:null!=(d=e.default_monthly_member_credit_limit)?d:null})},onError:e=>{(0,S.Ni)(e)}});return{updateWorkspace:u,isUpdatingWorkspace:m}}},26181:(e,t,r)=>{var a=r(6592),n=r(89498);e.exports=function(e){return a(n(e))}},26294:(e,t,r)=>{"use strict";r.d(t,{c3:()=>i});var a=r(73279);function n(e,t){return(...e)=>{try{return t(...e)}catch{throw Error(void 0)}}}let i=n(0,a.c3);n(0,a.kc)},27549:(e,t,r)=>{"use strict";r.d(t,{C5:()=>y,MJ:()=>g,Rr:()=>v,eI:()=>f,lR:()=>h,lV:()=>c,zB:()=>d});var a=r(77145),n=r(55851),i=r(95661),s=r(52037),o=r(77563),l=r(56024);let c=s.Op,u=i.createContext({}),d=e=>{let{...t}=e;return(0,a.jsx)(u.Provider,{value:{name:t.name},children:(0,a.jsx)(s.xI,{...t})})},m=()=>{let e=i.useContext(u),t=i.useContext(p),{getFieldState:r,formState:a}=(0,s.xW)(),n=r(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...n}},p=i.createContext({}),f=i.forwardRef((e,t)=>{let{className:r,...n}=e,s=i.useId();return(0,a.jsx)(p.Provider,{value:{id:s},children:(0,a.jsx)("div",{ref:t,className:(0,l.cn)("space-y-2",r),...n})})});f.displayName="FormItem";let h=i.forwardRef((e,t)=>{let{className:r,...n}=e,{error:i,formItemId:s}=m();return(0,a.jsx)(o.Label,{ref:t,className:(0,l.cn)(i&&"",r),htmlFor:s,...n})});h.displayName="FormLabel";let g=i.forwardRef((e,t)=>{let{...r}=e,{error:i,formItemId:s,formDescriptionId:o,formMessageId:l}=m();return(0,a.jsx)(n.DX,{ref:t,id:s,"aria-describedby":i?"".concat(o," ").concat(l):"".concat(o),"aria-invalid":!!i,...r})});g.displayName="FormControl";let v=i.forwardRef((e,t)=>{let{className:r,...n}=e,{formDescriptionId:i}=m();return(0,a.jsx)("p",{ref:t,id:i,className:(0,l.cn)("text-sm text-muted-foreground",r),...n})});v.displayName="FormDescription";let y=i.forwardRef((e,t)=>{let{className:r,children:n,...i}=e,{error:s,formMessageId:o}=m(),c=s?String(null==s?void 0:s.message):n;return c?(0,a.jsx)("p",{ref:t,id:o,className:(0,l.cn)("text-xs font-medium text-destructive-primary",r),...i,children:c}):null});y.displayName="FormMessage"},29753:(e,t,r)=>{var a=r(77666),n=r(32284),i=r(88201),s=r(16274),o=r(19951),l=r(16169),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),u=!r&&n(e),d=!r&&!u&&s(e),m=!r&&!u&&!d&&l(e),p=r||u||d||m,f=p?a(e.length,String):[],h=f.length;for(var g in e)(t||c.call(e,g))&&!(p&&("length"==g||d&&("offset"==g||"parent"==g)||m&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||o(g,h)))&&f.push(g);return f}},30425:(e,t,r)=>{"use strict";r.d(t,{w:()=>y});var a=r(77145),n=r(87299),i=r(6698),s=r(95661),o=r(31088),l=r(40702),c=r(69730),u=r(14618),d=r(63851),m=r(65616),p=r(69850),f=r(56024),h=r(52597),g=r(58295);let v=["image/png","image/jpeg","image/jpg","image/webp"],y=e=>{let{workspace:t,className:r}=e,{authUser:y}=(0,l.Z2)(),x=(0,d.P)(),{upload:b}=(0,u.l)(),j=(0,n.jE)(),w=(0,s.useRef)(null),k=()=>{w.current&&(w.current.value="")},{mutateAsync:N,isPending:S}=(0,i.n)({mutationFn:async e=>{let{file:r,workspaceId:a}=e;if(!y)throw Error("You must be logged in to upload files");await b({fileName:r.name,file:r,options:{maxFileSize:10240,maxDimension:200},continueOnError:!1});let{url:n}=await (0,m.QN)({dir_name:y.uid,file_name:r.name});return await x.put("/user/workspaces/".concat(t.id),{image_url:n})},onSuccess:(e,t)=>{o.toast.success("Updated workspace avatar",{description:"Succesfully uploaded new workspace avatar"}),j.invalidateQueries({queryKey:p.workspaceKeys.all}),k()},onError:()=>{o.toast.error("Failed to update workspace avatar",{description:"Please try again"}),k()}}),E=async e=>{var r;let a=null==(r=e.target.files)?void 0:r[0];a&&await N({file:a,workspaceId:t.id})};return(0,a.jsxs)(g.m_,{children:[(0,a.jsx)(g.k$,{asChild:!0,children:(0,a.jsxs)("button",{type:"button",disabled:S,onClick:()=>{var e;null==(e=w.current)||e.click()},className:(0,f.cn)("absolute inset-0 flex items-center justify-center rounded-lg bg-black/60 transition-opacity duration-200",S?"opacity-100":"opacity-0 hover:opacity-100","cursor-pointer disabled:cursor-default",r),children:[(0,a.jsx)("input",{type:"file",className:"hidden",accept:v.join(","),onChange:E,disabled:S,ref:w}),S?(0,a.jsx)(h.y,{size:"small",className:"text-white"}):(0,a.jsx)(c.A,{name:"pen",size:"small",className:"text-white"})]})}),(0,a.jsx)(g.ZI,{side:"right",children:"Upload a new workspace avatar"})]})}},32284:(e,t,r)=>{var a=r(3164),n=r(66700),i=Object.prototype,s=i.hasOwnProperty,o=i.propertyIsEnumerable;e.exports=a(function(){return arguments}())?a:function(e){return n(e)&&s.call(e,"callee")&&!o.call(e,"callee")}},32313:(e,t,r)=>{"use strict";r.d(t,{T:()=>s});var a=r(77145),n=r(95661),i=r(56024);let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex w-full rounded-md border border-input bg-muted px-2 py-2 text-sm transition-colors duration-150 ease-in-out placeholder:text-muted-foreground hover:border-ring/20 focus-visible:border-ring focus-visible:outline-none disabled:cursor-not-allowed disabled:border-input disabled:opacity-50",r),ref:t,...n})});s.displayName="Textarea"},32736:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,M:()=>a});var a=function(e){return e.EXISTING_USER_LOGIN="existingUserLogin",e.SIGNUP="signup",e.SEGMENTATION="segmentation",e}({}),n=function(e){return e.CLAIM_REWARD="claimReward",e.REMIX_PROJECT="remixProject",e}({})},33499:(e,t,r)=>{"use strict";r.d(t,{Analytics:()=>s,s:()=>i});var a=r(95661);function n(){return"undefined"!=typeof window&&window.dubAnalytics}function i(){let[e,t]=(0,a.useState)({partner:null,discount:null}),r=(0,a.useCallback)(()=>{n()&&window.dubAnalytics("ready",()=>{let{partner:e=null,discount:r=null}=window.DubAnalytics||{};t({partner:e,discount:r})})},[]),i=(0,a.useCallback)(e=>{n()&&window.dubAnalytics.trackClick(e)},[]),s=(0,a.useCallback)(e=>{n()&&window.dubAnalytics.trackLead(e)},[]),o=(0,a.useCallback)(e=>{n()&&window.dubAnalytics.trackSale(e)},[]);return(0,a.useEffect)(()=>{r()},[r]),{...e,trackClick:i,trackLead:s,trackSale:o}}function s(e){return(0,a.useEffect)(()=>{!function(e){var t,r,a,n,i,s,o;if("undefined"==typeof window)return;o="dubAnalytics",(s=window)[o]=s[o]||function(){(s[o].q=s[o].q||[]).push(arguments)},["trackClick","trackLead","trackSale"].forEach(function(e){s[o][e]=function(){s[o](e,...Array.from(arguments))}});let l="https://www.dubcdn.com/analytics/script",c=[];(null==(t=e.domainsConfig)?void 0:t.site)&&c.push("site-visit"),(null==(r=e.domainsConfig)?void 0:r.outbound)&&c.push("outbound-domains"),e.publishableKey&&c.push("conversion-tracking");let u=(null==(a=e.scriptProps)?void 0:a.src)||(c.length>0?"".concat(l,".").concat(c.join("."),".js"):"".concat(l,".js"));if(document.head.querySelector('script[src*="'.concat(u,'"]')))return;let d=document.createElement("script");if(d.src=u,d.defer=null==(i=null==(n=e.scriptProps)?void 0:n.defer)||i,d.setAttribute("data-sdkn","@dub/analytics"),d.setAttribute("data-sdkv","0.0.30"),e.apiHost&&d.setAttribute("data-api-host",e.apiHost),e.publishableKey&&d.setAttribute("data-publishable-key",e.publishableKey),e.domainsConfig&&d.setAttribute("data-domains",JSON.stringify(e.domainsConfig)),e.shortDomain&&d.setAttribute("data-short-domain",e.shortDomain),e.attributionModel&&d.setAttribute("data-attribution-model",e.attributionModel),e.cookieOptions&&Object.keys(e.cookieOptions).length>0&&d.setAttribute("data-cookie-options",JSON.stringify(e.cookieOptions)),e.queryParam&&d.setAttribute("data-query-param",e.queryParam),e.scriptProps){let{src:t,...r}=e.scriptProps;Object.assign(d,r)}d.onerror=()=>{console.log("[Dub Web Analytics] failed to load script from ".concat(u,"."))},document.head.appendChild(d)}(e)},[e]),null}},41541:(e,t,r)=>{"use strict";r.d(t,{H:()=>o});var a=r(18502),n=r(83220),i=r(99989),s=r(51804);let o=()=>{var e,t;let r=(0,n.j4)(e=>e.currentWorkspace),{data:o,isLoading:l}=(0,a.I)(i.y.referralCreditsConfig({workspaceId:null==r?void 0:r.id}));return{inviteeCredits:null!=(e=null==o?void 0:o.invitee_credits)?e:s.aM,advocateCredits:null!=(t=null==o?void 0:o.advocate_credits)?t:s.xp,isLoading:l}}},43178:(e,t,r)=>{e.exports=r(77769)(Object.keys,Object)},43762:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},47188:(e,t,r)=>{var a=r(7065),n=r(55485),i=r(43762),s=a?a.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?n(e):i(e)}},47428:(e,t,r)=>{var a=r(60849),n=r(43178),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!a(e))return n(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},50444:(e,t,r)=>{"use strict";r.d(t,{z:()=>u});var a=r(87299),n=r(95661),i=r(28717),s=r(49493),o=r(19620),l=r(70556);let c="post-auth-action",u=()=>{let e=(0,a.jE)(),{userData:t}=(0,i.ur)(),r=(0,s.k9)(),{workspaces:u}=(0,s.Mu)(e=>({workspaces:e.workspaces})),d=(0,n.useCallback)((e,t,r)=>{try{let a={key:e,params:t,contexts:r,timestamp:Date.now()},n=l.WS.get(e);if(!n)return void o.logging.error("Unknown post-auth action",{actionKey:e,availableActions:Array.from(l.WS.keys())});let i=n.paramsSchema.safeParse(t);if(!i.success)return void o.logging.error("Invalid params for post-auth action",{actionKey:e,params:t,error:i.error});localStorage.setItem(c,JSON.stringify(a))}catch(t){o.logging.error("Failed to store post-auth action",{error:t,actionKey:e})}},[]),m=(0,n.useCallback)(async(a,n,i)=>{let s=l.WS.get(a);if(!s)return o.logging.error("Unknown post-auth action",{actionKey:a,availableActions:Array.from(l.WS.keys())}),"/";let c=s.paramsSchema.safeParse(n);if(!c.success)return o.logging.error("Invalid params for post-auth action",{actionKey:a,params:n,error:c.error}),"/";let d={userId:null==t?void 0:t.id,workspaces:u,...i},m=await s.execute(c.data,d);if(m.workspaceUpdate&&(null==r?void 0:r.store)){let e=r.store.getState().workspaces.map(e=>e.id===m.workspaceUpdate.workspaceId?{...e,...m.workspaceUpdate.updates}:e);r.store.setState({workspaces:e})}return m.invalidateQueries&&m.invalidateQueries.length>0&&setTimeout(()=>{m.invalidateQueries.forEach(t=>{e.invalidateQueries({queryKey:t})})},2e3),m.redirectUrl||"/"},[e,t,r,u]);return{storeAction:d,executeStoredAction:(0,n.useCallback)(async()=>{try{let e=localStorage.getItem(c);if(!e)return"/";let t=JSON.parse(e),r=l.th.safeParse(t);if(!r.success)return o.logging.error("Invalid stored action",{error:r.error}),localStorage.removeItem(c),"/";let a=r.data;if(a.timestamp&&Date.now()-a.timestamp>864e5)return localStorage.removeItem(c),"/";let n=await m(a.key,a.params);return localStorage.removeItem(c),n}catch(e){if(localStorage.removeItem(c),o.logging.error("Failed to execute stored action",{error:e}),e instanceof Error)throw e;throw Error("Unknown error occurred while executing stored action",{cause:e})}},[m]),executeAction:m,shouldRunAction:(0,n.useCallback)(e=>{try{let t=localStorage.getItem(c);if(!t)return!1;let r=JSON.parse(t),a=l.th.safeParse(r);if(!a.success)return localStorage.removeItem(c),!1;return a.data.contexts.includes(e)}catch(t){return o.logging.error("Failed to check if action should run",{error:t,context:e}),!1}},[])}}},51804:(e,t,r)=>{"use strict";r.d(t,{aM:()=>a,qK:()=>i,xp:()=>n});let a=10,n=10,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"light";return 50===e?"dark"===t?"/img/referral/dark-spread-50.png":"/img/referral/light-spread-50.png":"dark"===t?"/img/referral/dark-spread.png":"/img/referral/light-spread.png"}},53306:(e,t,r)=>{var a=r(86344);e.exports=function(e,t){return a(t,function(t){return e[t]})}},55485:(e,t,r)=>{var a=r(7065),n=Object.prototype,i=n.hasOwnProperty,s=n.toString,o=a?a.toStringTag:void 0;e.exports=function(e){var t=i.call(e,o),r=e[o];try{e[o]=void 0;var a=!0}catch(e){}var n=s.call(e);return a&&(t?e[o]=r:delete e[o]),n}},57841:(e,t,r)=>{"use strict";r.d(t,{z:()=>s});var a=r(77145),n=r(59142),i=r(90249);let s=e=>{var t;let{isInteractive:r=!1,className:s,workspace:o,...l}=e,c=(0,i.Q)(null==o?void 0:o.id),u=null==o?void 0:o.name,d=null!=(t=null==o?void 0:o.image_url)?t:void 0;return(0,a.jsx)(n._,{name:u,isInteractive:r,photoSrc:d,userColor:c,className:s,isWorkspace:!0,...l})}},59515:e=>{e.exports=function(e){return function(t){return e(t)}}},60849:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},61035:(e,t,r)=>{"use strict";r.d(t,{D:()=>c,N:()=>u});var a=r(95661);let n=["light","dark"],i="(prefers-color-scheme: dark)",s="undefined"==typeof window,o=(0,a.createContext)(void 0),l={setTheme:e=>{},themes:[]},c=()=>{var e;return null!=(e=(0,a.useContext)(o))?e:l},u=e=>(0,a.useContext)(o)?a.createElement(a.Fragment,null,e.children):a.createElement(m,e),d=["light","dark"],m=({forcedTheme:e,disableTransitionOnChange:t=!1,enableSystem:r=!0,enableColorScheme:s=!0,storageKey:l="theme",themes:c=d,defaultTheme:u=r?"system":"light",attribute:m="data-theme",value:v,children:y,nonce:x})=>{let[b,j]=(0,a.useState)(()=>f(l,u)),[w,k]=(0,a.useState)(()=>f(l)),N=v?Object.values(v):c,S=(0,a.useCallback)(e=>{let a=e;if(!a)return;"system"===e&&r&&(a=g());let i=v?v[a]:a,o=t?h():null,l=document.documentElement;if("class"===m?(l.classList.remove(...N),i&&l.classList.add(i)):i?l.setAttribute(m,i):l.removeAttribute(m),s){let e=n.includes(u)?u:null,t=n.includes(a)?a:e;l.style.colorScheme=t}null==o||o()},[]),E=(0,a.useCallback)(e=>{j(e);try{localStorage.setItem(l,e)}catch(e){}},[e]),C=(0,a.useCallback)(t=>{k(g(t)),"system"===b&&r&&!e&&S("system")},[b,e]);(0,a.useEffect)(()=>{let e=window.matchMedia(i);return e.addListener(C),C(e),()=>e.removeListener(C)},[C]),(0,a.useEffect)(()=>{let e=e=>{e.key===l&&E(e.newValue||u)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[E]),(0,a.useEffect)(()=>{S(null!=e?e:b)},[e,b]);let I=(0,a.useMemo)(()=>({theme:b,setTheme:E,forcedTheme:e,resolvedTheme:"system"===b?w:b,themes:r?[...c,"system"]:c,systemTheme:r?w:void 0}),[b,E,e,w,r,c]);return a.createElement(o.Provider,{value:I},a.createElement(p,{forcedTheme:e,disableTransitionOnChange:t,enableSystem:r,enableColorScheme:s,storageKey:l,themes:c,defaultTheme:u,attribute:m,value:v,children:y,attrs:N,nonce:x}),y)},p=(0,a.memo)(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:s,enableColorScheme:o,defaultTheme:l,value:c,attrs:u,nonce:d})=>{let m="system"===l,p="class"===r?`var d=document.documentElement,c=d.classList;c.remove(${u.map(e=>`'${e}'`).join(",")});`:`var d=document.documentElement,n='${r}',s='setAttribute';`,f=o?n.includes(l)&&l?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${l}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(e,t=!1,a=!0)=>{let i=c?c[e]:e,s=t?e+"|| ''":`'${i}'`,l="";return o&&a&&!t&&n.includes(e)&&(l+=`d.style.colorScheme = '${e}';`),"class"===r?l+=t||i?`c.add(${s})`:"null":i&&(l+=`d[s](n,${s})`),l},g=e?`!function(){${p}${h(e)}}()`:s?`!function(){try{${p}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${m})){var t='${i}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${c?`var x=${JSON.stringify(c)};`:""}${h(c?"x[e]":"e",!0)}}${m?"":"else{"+h(l,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${p}var e=localStorage.getItem('${t}');if(e){${c?`var x=${JSON.stringify(c)};`:""}${h(c?"x[e]":"e",!0)}}else{${h(l,!1,!1)};}${f}}catch(t){}}();`;return a.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:g}})},()=>!0),f=(e,t)=>{let r;if(!s){try{r=localStorage.getItem(e)||void 0}catch(e){}return r||t}},h=()=>{let e=document.createElement("style");return e.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}},g=e=>(e||(e=window.matchMedia(i)),e.matches?"dark":"light")},61884:(e,t,r)=>{"use strict";r.d(t,{P:()=>a});let a=(0,r(84510).vt)(e=>({shouldShowReferralNotice:!1,setIsSuccessfulReferral:()=>e({shouldShowReferralNotice:!0})}))},62548:(e,t,r)=>{"use strict";r.d(t,{g:()=>a});var a=function(e){return e.USER_UPLOAD="user_upload",e.IFRAME_SNAPSHOT="iframe_snapshot",e}({})},62996:(e,t,r)=>{e.exports="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g},63185:e=>{e.exports=function(e,t){var r=-1,a=e.length;for(t||(t=Array(a));++r<a;)t[r]=e[r];return t}},65616:(e,t,r)=>{"use strict";r.d(t,{PE:()=>s,QM:()=>i,QN:()=>o});var a=r(63851),n=r(19620);let i=async function(e,t,i){var s,o;let l=!(arguments.length>3)||void 0===arguments[3]||arguments[3],c=null!=(s=null==i?void 0:i.maxFileSize)?s:3145728,u=null!=(o=null==i?void 0:i.maxDimension)?o:2e3,d=t;if(t.type.startsWith("image/"))if(["image/svg+xml","image/gif","image/x-icon","image/vnd.microsoft.icon"].includes(t.type))d=t;else{let e=new Image,a=URL.createObjectURL(t);try{if(await new Promise(t=>{e.onload=()=>{URL.revokeObjectURL(a),t()},e.onerror=()=>{URL.revokeObjectURL(a),t()},e.src=a}),t.size>c||Math.max(e.width,e.height)>u)try{let{default:e}=await r.e(4088).then(r.bind(r,94088));d=await e(t,{maxSizeMB:c/1024/1024,maxWidthOrHeight:Math.min(u,1920),useWebWorker:!0})}catch(e){if(n.logging.error("Error compressing image:",{error:e}),!l)throw e}}catch(e){n.logging.warn("Could not process image for compression, using original",{error:e}),d=t}}let m={file_name:e,content_type:d.type,status:"uploading"},p=await (0,a.P)().post("/files/generate-upload-url",m),f=await fetch(p.url,{method:"PUT",body:d,headers:{"Content-Type":d.type}});if(!f.ok){let t=Error("Upload failed with status ".concat(f.status));if(n.logging.error("File upload failed:",{fileName:e,status:f.status}),!l)throw t}},s=async e=>(0,a.P)().post("/files/generate-download-url",e),o=async e=>(0,a.P)().post("/files/generate-public-url",e)},66700:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},69777:(e,t,r)=>{"use strict";r.d(t,{A2:()=>a.A,MR:()=>a.M});var a=r(32736);r(70556),r(11070)},70556:(e,t,r)=>{"use strict";r.d(t,{WS:()=>o,th:()=>l});var a=r(75222),n=r(11070),i=r(32736);let s=[n.K,n.N],o=new Map;s.forEach(e=>{o.set(e.key,e)}),Object.fromEntries(s.map(e=>[e.key,e.paramsSchema]));let l=a.gM("key",s.map(e=>{let t,r;return t=e.key,r=e.paramsSchema,a.Ik({key:a.eu(t),params:r.optional(),contexts:a.YO(a.fc(i.M)),timestamp:a.ai().optional()})}))},73893:(e,t,r)=>{"use strict";r.d(t,{E:()=>o,m:()=>s});var a=r(77145),n=r(56024),i=r(39055);let s=e=>{let{children:t,label:r,className:s,isLast:o=!1,description:l,badges:c,customBadge:u,mobileLayout:d="vertical",justify:m="start",...p}=e;return(0,a.jsxs)("div",{className:(0,n.cn)("relative grid gap-4 pb-4 last:border-b-0 md:grid md:grid-cols-2",{"border-b-0":o,"border-b":!o,"flex justify-between":"horizontal"===d,"grid-cols-1":"vertical"===d},s),...p,children:[(r||l)&&(0,a.jsxs)("div",{className:"flex-col gap-1 md:flex",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-x-1.5 text-base font-medium",children:[r,null==c?void 0:c.map(e=>(0,a.jsx)(i.x,{badge:e},e)),u]}),l&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:l})]}),t&&(0,a.jsx)("div",{className:(0,n.cn)("flex items-center","end"===m&&"md:justify-end"),children:t})]})},o=e=>{let{children:t,className:r,...i}=e;return(0,a.jsx)("div",{className:(0,n.cn)("absolute inset-x-0 bottom-0 z-10 flex min-h-8 items-center rounded-b-lg border-t bg-background px-6 py-3 md:px-10",r),...i,children:t})}},74131:e=>{e.exports=function(){return!1}},77666:e=>{e.exports=function(e,t){for(var r=-1,a=Array(e);++r<e;)a[r]=t(r);return a}},77769:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},81347:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},82704:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}},82862:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>em});var a=r(77145),n=r(33499),i=r(13410),s=r(95661),o=r(40702),l=r(3140),c=r(28717),u=r(54436),d=r(21227),m=r(31088),p=r(90936),f=r(50444),h=r(69777),g=r(26294),v=r(20247),y=r(27549),x=r(27458),b=r(92722),j=r.n(b);let w=e=>{let t=[...e],r=t.findIndex(e=>"other"===e.value);if(-1===r)return j()(t);let[a]=t.splice(r,1),n=j()(t);return n.push(a),n},k=e=>e.split(" ")[0].trim();var N=r(52811),S=r(6397),E=r(56024);let C=[{value:"website"},{value:"saas"},{value:"design"},{value:"ecommerce"},{value:"games"},{value:"internal_tools"},{value:"prototyping"},{value:"side_projects"},{value:"other"}],I=[{value:"x"},{value:"youtube"},{value:"linkedin"},{value:"github"},{value:"newsletter"},{value:"press_media"},{value:"reddit"},{value:"google"},{value:"friend"},{value:"colleague"},{value:"tiktok"},{value:"instagram"},{value:"facebook"},{value:"other"}],A=[{value:"software_developer"},{value:"product_manager"},{value:"entrepreneur"},{value:"creator"},{value:"designer"},{value:"marketer"},{value:"student"},{value:"educator"},{value:"hobbyist"},{value:"other"}],_=[{value:"personal_projects"},{value:"work_professional"},{value:"academic_research"},{value:"other"}],T="min-h-[160px]",M=[{type:"NAME",title:"steps.name",field:"fullName"},{type:"INVITE",title:"steps.invite"}],O=e=>{let{control:t,theme:r,onThemeChange:n,onNext:i,triggerValidation:s,hasErrors:o=!1}=e,l=(0,g.c3)("GettingStarted");return(0,a.jsx)(y.zB,{control:t,name:"fullName",render:e=>{let{field:t}=e;return(0,a.jsx)(y.eI,{children:(0,a.jsxs)("div",{className:(0,E.cn)("flex flex-col justify-start gap-3",T),children:[(0,a.jsx)("p",{className:"text-base font-medium",children:l("nameStep.question")}),(0,a.jsx)(y.MJ,{children:(0,a.jsx)(S.p,{placeholder:l("nameStep.placeholder"),...t,onKeyDown:async e=>{"Enter"===e.key&&(e.preventDefault(),await s("fullName")&&await i())}})}),(0,a.jsx)("p",{className:"text-base font-medium",children:l("nameStep.themeQuestion")}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(N.$,{type:"button",variant:"system"===r?"accent":"outline",className:(0,E.cn)("h-7 whitespace-nowrap border px-4 text-left transition-colors"),onClick:()=>n("system"),children:l("nameStep.themes.system")}),(0,a.jsx)(N.$,{type:"button",variant:"dark"===r?"accent":"outline",className:(0,E.cn)("h-7 whitespace-nowrap border px-4 text-left transition-colors"),onClick:()=>n("dark"),children:l("nameStep.themes.dark")}),(0,a.jsx)(N.$,{type:"button",variant:"light"===r?"accent":"outline",className:(0,E.cn)("h-7 whitespace-nowrap border px-4 text-left transition-colors"),onClick:()=>n("light"),children:l("nameStep.themes.light")})]}),o&&(0,a.jsx)(y.C5,{})]})})}})};var P=r(69730),U=r(51747);let L=e=>{let{placeholder:t="email@example.com",emails:r,setEmails:n,onValidationChange:i}=e,{authUser:l}=(0,o.Z2)(),c=null==l?void 0:l.email,[u,d]=(0,s.useState)([]),[m,p]=(0,s.useState)([null,null,null]),[f,h]=(0,s.useState)(new Set);(0,s.useEffect)(()=>{let{globalErrors:e,fieldErrors:t}=(0,U.VC)(r,c);d(e),p(t);let a=0===e.length&&t.every((e,t)=>!e||!r[t]);null==i||i(a,[...e,...t.filter(e=>!!e)])},[r,i,c]);let g=e=>{var t;return(null==(t=r[e])?void 0:t.trim())&&f.has(e)?m[e]:null},v=e=>null!==g(e);return(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[[0,1,2].map(e=>(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)(S.p,{type:"email",value:r[e],onChange:t=>((e,t)=>{let a=[...r];a[e]=t,n(a),h(t=>new Set(t).add(e))})(e,t.target.value),onBlur:()=>{h(t=>new Set(t).add(e))},placeholder:t,className:"rounded-md border px-4 py-2 text-base ".concat(v(e)?"border-destructive focus:border-destructive":"")}),v(e)&&(0,a.jsx)("p",{className:"text-sm text-destructive-foreground",children:g(e)})]},e)),u.length>0&&(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 rounded-md border border-destructive bg-destructive px-4 py-3 text-center text-base font-medium text-destructive-foreground",children:[(0,a.jsx)(P.A,{name:"warning",className:"font-base h-4 w-4"}),(0,a.jsx)("p",{className:"font-base text-sm",children:u[0]})]})]})};var D=r(52597),F=r(92912),R=r(39528);let $=e=>{let{buttonType:t,step:r,action:a,additionalData:n}=e,i=R.Ue.BUTTON_CLICKED[t];F.Ay.capture(i,{step:r,action:a,...n})},W=e=>{let{currentWorkspace:t,emails:r,setEmails:n,onValidationChange:i}=e,o=(0,g.c3)("GettingStarted");return(0,s.useEffect)(()=>{F.Ay.capture(R.Ue.STEP_VIEWED.INVITE_STEP)},[]),(0,a.jsx)("div",{className:"flex flex-col justify-start gap-4 ".concat(T),children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-base text-muted-foreground",children:o("inviteStep.description")}),(0,a.jsx)(L,{emails:r,setEmails:n,onValidationChange:e=>{null==i||i(e)}})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-md border border-dashed border-muted-foreground/40 bg-muted/40 px-4 py-3",children:[(0,a.jsx)(D.y,{size:"small",className:"text-muted-foreground"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:o("inviteStep.workspaceLoading")})]})})};var V=r(75222);let K=V.Ik({fullName:V.Yj().min(1,{message:"Full name is required"}).max(100,{message:"Full name must be less than 100 characters"}).or(V.eu("")),theme:V.k5(["system","dark","light"]).optional()}),z=e=>{let{step:t,form:r,themeConfig:n,onNext:i,currentWorkspace:s,inviteConfig:o}=e,l=(0,g.c3)("GettingStarted"),{control:c}=r,{theme:u,onThemeChange:d}=n,{emails:m,setEmails:p,onValidationChange:f}=o;return(0,a.jsxs)(a.Fragment,{children:["NAME"!==t.type&&(0,a.jsx)("div",{className:"",children:(0,a.jsx)("h2",{className:"text-2xl font-medium",children:l(t.title)})}),(()=>{switch(t.type){case"NAME":return(0,a.jsx)(O,{control:c,theme:u,onThemeChange:d,onNext:i,triggerValidation:r.trigger,hasErrors:((e,t)=>!!(e.formState.touchedFields[t]&&e.formState.errors[t]))(r,"fullName")});case"INVITE":return(0,a.jsx)(W,{currentWorkspace:s,emails:m,setEmails:p,onValidationChange:f});default:return null}})()]})},B=e=>{let{stepState:t,formState:r,onContinue:n,onFinish:i}=e,s=(0,g.c3)("GettingStarted"),{step:o,isLastStep:l,isNameStep:c,isInviteStep:u}=t,{form:d,mutation:m,isInvitingMember:p,inviteEmailsValid:f=!0}=r;return l?(0,a.jsx)(N.$,{type:"button",className:"h-7",onClick:()=>{$({buttonType:"SUBMIT",step:"invite_step",action:"submit"}),i()},disabled:m.isPending||m.isSuccess||p,children:s("navigation.finish")}):c?(0,a.jsx)(N.$,{type:"button",className:"h-7",onClick:()=>{c?$({buttonType:"CONTINUE_NAME_STEP",step:"name_step",action:"continue"}):u?$({buttonType:"CONTINUE",step:"invite_step",action:"continue"}):$({buttonType:"CONTINUE",step:o.field,action:"continue"}),n()},disabled:!d.getValues("fullName"),children:s("navigation.continue")}):null},Y=e=>{let{stepState:t,formState:r,actions:n,authUser:i}=e,s=(0,g.c3)("GettingStarted"),{currentStep:o,step:l,isInviteStep:c}=t,{onBack:u,onSkip:d,onContinue:m,onFinish:p}=n,f=async()=>{c&&F.Ay.capture(R.Ue.STEP_SKIPPED.INVITE_STEP),$({buttonType:"SKIP",step:l.field,action:"skip"}),await d()},h=o>+(null!=i&&!!i.displayName);return(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex justify-start",children:h&&(0,a.jsx)(N.$,{type:"button",variant:"ghost",onClick:()=>{$({buttonType:"BACK",step:l.field||"invite_step",action:"back"}),u()},className:"h-7 w-12",children:s("navigation.back")})}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[c&&(0,a.jsx)(N.$,{type:"button",variant:"ghost",className:"h-7 text-sm text-muted-foreground hover:text-foreground",onClick:f,children:s("navigation.skip")}),(0,a.jsx)(B,{stepState:t,formState:r,onContinue:m,onFinish:p})]})]})};var J=r(47226),q=r(41541);let G=e=>{let{onContinue:t}=e,{inviteeCredits:r,isLoading:n}=(0,q.H)();return(0,a.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,a.jsx)(v.c7,{children:(0,a.jsx)(v.L3,{className:"text-left text-2xl font-medium",children:"Congratulations!"})}),(0,a.jsx)("div",{children:"You have earned"}),(0,a.jsx)("div",{className:"rounded-xl bg-muted py-8 text-center text-4xl font-medium",children:n?(0,a.jsx)(J.E,{className:"mx-auto h-10 w-48"}):"+".concat(r," credits")}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Thanks to the user that referred you. You can use these credits to create projects, generate content, and more."}),(0,a.jsx)(N.$,{onClick:t,children:"Continue"})]})};var Q=r(9898),Z=r(61035),H=r(52037),X=r(83220),ee=r(51328),et=r(25249),er=r(6698),ea=r(75698),en=r(83473),ei=r(63851),es=r(35418),eo=r(19620),el=r(45756),ec=r(61884);let eu=e=>{var t;let{dialogOpen:r,onSettled:n}=e,i=(0,g.c3)("GettingStarted"),{navigation:l,auth:u,referralNotice:d,invites:m,form:p,currentWorkspace:f,shuffledOptions:h,submitMutation:b,actions:j}=(e=>{var t;let{dialogOpen:r,onSettled:a}=e,{authUser:n,authState:i}=(0,o.Z2)(),[l,c]=(0,s.useState)(0),{theme:u,setTheme:d}=(0,Z.D)(),{shouldShowReferralNotice:m}=(0,ec.P)(),[p,f]=(0,s.useState)(m),[h,g]=(0,s.useState)(["","",""]),[v,y]=(0,s.useState)(!0);(0,s.useEffect)(()=>{"authenticated"===i&&n&&c(+!!n.displayName)},[i,n]);let x=(0,H.mN)({resolver:(0,Q.u)(K),defaultValues:{fullName:"",theme:void 0}});(0,s.useEffect)(()=>{"authenticated"===i&&(null==n?void 0:n.displayName)&&x.setValue("fullName",n.displayName)},[i,n,x]);let b=(0,H.mN)({defaultValues:{name:""}}),j=(0,X.j4)(e=>e.currentWorkspace),{updateWorkspace:N}=(0,et.U)({form:b,workspaceId:null!=(t=null==j?void 0:j.id)?t:"",quietSuccess:!0}),{inviteWorkspaceMember:S,isInvitingMember:E}=(0,ee.s)({workspaceId:(null==j?void 0:j.id)||""}),T=(0,er.n)({mutationFn:async()=>(0,ei.P)().post("/user/segmentation",{form_status:el.C.SKIPPED}),onError:e=>{(0,en.Ni)(e)},onSettled:(e,t)=>{a({data:e,error:t,variables:{data:void 0,formStatus:el.C.SKIPPED},context:void 0})}}),O=(0,er.n)({mutationFn:async e=>{let t=(0,ei.P)(),r=K.parse(e),a={form_status:el.C.SUBMITTED,theme:r.theme};return t.post("/user/segmentation",a)},onSuccess:()=>{},onError:e=>{eo.logging.error("Error submitting user segmentation data",{error:e}),(0,en.Ni)(e)},onSettled:(e,t,r)=>{a({data:e,error:t,variables:{data:r,formStatus:el.C.SUBMITTED},context:void 0})}}),P=(0,er.n)({mutationFn:async e=>{var t;let r=(0,ei.P)();if(!(null==(t=es.auth.currentUser)?void 0:t.uid))throw Error("No authenticated user found");let a=e.trim();if(!a)throw Error("Display name cannot be empty");let n=await r.put("/user/".concat(es.auth.currentUser.uid),{attributes:{display_name:a}});try{await (0,ea.r7)(es.auth.currentUser,{displayName:a})}catch(e){eo.logging.error("Failed to update Firebase Auth display name",{firebaseError:e})}return n},onSuccess:()=>{},onError:e=>{eo.logging.error("Failed to update user display name",{error:e}),(0,en.Ni)(e)}}),{onSubmit:L,handleSkip:D,handleDialogClose:W,handleNext:V,handleBack:z,handleThemeChange:B,handleInvite:Y}=(e=>{let{currentStep:t,setCurrentStep:r,form:a,workspaceForm:n,skipMutation:i,submitMutation:s,updateUserMutation:o,updateWorkspace:l,inviteWorkspaceMember:c,setTheme:u,authUser:d}=e,m=(0,X.j4)(e=>{var t;return null==(t=e.membership)?void 0:t.role}),p=async e=>{await o.mutateAsync(e);let t=k(e);n.setValue("name","".concat(t,"'s Lovable")),("owner"===m||"admin"===m)&&l(n.getValues())},f=async e=>{F.Ay.capture(R.Ue.DIALOG.SUBMITTED),await s.mutateAsync(e),e.fullName&&e.fullName.trim()&&await p(e.fullName)},h=async()=>{F.Ay.capture(R.Ue.DIALOG.SKIPPED);let e=a.getValues();e.fullName&&e.fullName.trim()&&await p(e.fullName),await i.mutateAsync()},g=async()=>{t<M.length-1?r(t+1):await a.handleSubmit(f)()};return{onSubmit:f,handleSkip:h,handleDialogClose:e=>{if(!e&&!i.isPending&&!s.isPending&&!i.isSuccess&&!s.isSuccess&&!o.isPending){let e=a.getValues();Object.values(e).some(e=>void 0!==e&&""!==e)?(F.Ay.capture(R.Ue.DIALOG.PARTIAL_SUBMIT),e.fullName&&e.fullName.trim()?p(e.fullName).then(()=>s.mutateAsync(e)).catch(e=>{eo.logging.error("Error during dialog close submission",{error:e})}):s.mutate(e)):h()}},handleNext:g,handleBack:()=>{t>+(null!=d&&!!d.displayName)&&r(t-1)},handleThemeChange:e=>{(e=>{$({buttonType:"THEME",additionalData:{selection:e,label:"system"===e?"System Theme":"dark"===e?"Dark Mode":"Light Mode"}})})(e),u(e),a.setValue("theme",e)},handleInvite:async e=>{let{emails:t,role:r}=e;if(0===t.length)return{success:!1};let a=0;for(let e of t)try{await c({email:e,role:r}),a++}catch(t){eo.logging.error("Failed to invite team member",{email:e,error:t})}return{success:a>0}}}})({currentStep:l,setCurrentStep:c,form:x,workspaceForm:b,skipMutation:T,submitMutation:O,updateUserMutation:P,updateWorkspace:N,inviteWorkspaceMember:S,setTheme:d,authUser:n}),J=(0,s.useMemo)(()=>({buildGoal:w(C),primaryUseCase:w(_),role:w(A),heardFrom:w(I)}),[]);(0,s.useEffect)(()=>{r&&F.Ay.capture(R.Ue.DIALOG.VIEWED)},[r]),(0,s.useEffect)(()=>{r&&u&&(x.setValue("theme",u),F.Ay.capture(R.Ue.BUTTON_CLICKED.THEME,{selection:u,label:"system"===u?"System Theme":"dark"===u?"Dark Mode":"Light Mode"}))},[r,u,x]);let q=async()=>{let e=h.map(e=>e.trim()).filter(e=>""!==e),t=(0,U.wO)(e);if(!t.success)return void eo.logging.error("Email validation failed",{error:t.error,validEmails:e.length,context:"user_segmentation_invite_flow"});(e=>{F.Ay.capture(R.Ue.INVITE_FINISHED,{email_count:e,has_emails:e>0})})(e.length);let r=!0;if(e.length>0){let{success:t}=await Y({emails:e,role:"member"});r=t}r&&await x.handleSubmit(L)()};return{navigation:{currentStep:l,theme:u},auth:{authState:i,authUser:n},referralNotice:{isOpen:p,setIsOpen:f},invites:{emails:h,setEmails:g,isValid:v,setIsValid:y,isInviting:E},form:x,currentWorkspace:j,shuffledOptions:J,skipMutation:T,submitMutation:O,updateUserMutation:P,actions:{onSubmit:L,handleSkip:D,handleDialogClose:W,handleNext:V,handleBack:z,handleThemeChange:B,handleFinish:q},getFirstName:k}})({dialogOpen:r,onSettled:n}),{userData:N}=(0,c.ur)(),S=M[l.currentStep],E=l.currentStep===M.length-1,T=(null==S?void 0:S.field)==="fullName",O=(null==S?void 0:S.title)==="Invite your team";return"loading"!==u.authState&&"idle"!==u.authState&&N?(0,a.jsx)(v.lG,{open:r,onOpenChange:j.handleDialogClose,children:(0,a.jsxs)(v.Cf,{hideCloseButton:!0,blackoutOverlay:!0,onPointerDownOutside:e=>e.preventDefault(),onEscapeKeyDown:e=>e.preventDefault(),className:"max-h-[90vh] overflow-y-auto bg-popover",size:"md",children:[(0,a.jsx)(x.Fy,{className:"h-9 w-9"}),d.isOpen?(0,a.jsx)(G,{onContinue:()=>d.setIsOpen(!1)}):(0,a.jsxs)(a.Fragment,{children:[0===l.currentStep&&!(null==(t=u.authUser)?void 0:t.displayName)&&(0,a.jsx)(v.c7,{children:(0,a.jsx)(v.L3,{className:"text-left text-2xl font-medium",children:i("title")})}),(0,a.jsx)(y.lV,{...p,children:(0,a.jsxs)("form",{onSubmit:p.handleSubmit(j.onSubmit),className:"flex flex-col gap-4",children:[(0,a.jsx)(z,{step:S,form:p,themeConfig:{theme:l.theme,onThemeChange:j.handleThemeChange},onNext:j.handleNext,shuffledOptions:h,currentWorkspace:f,inviteConfig:{emails:m.emails,setEmails:m.setEmails,onValidationChange:m.setIsValid}}),(0,a.jsx)(Y,{stepState:{currentStep:l.currentStep,step:S,isLastStep:E,isNameStep:T,isInviteStep:O},formState:{form:p,mutation:b,isInvitingMember:m.isInviting,inviteEmailsValid:m.isValid},actions:{onBack:j.handleBack,onSkip:j.handleSkip,onContinue:()=>void j.handleNext(),onFinish:()=>void j.handleFinish()},authUser:u.authUser})]})})]})]})}):null},ed=()=>{let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),{shouldRunAction:r}=(0,f.z)(),{applyStoredPromotionCode:n}=(0,p.x)(),s=async a=>{if(n(),a.error){var i;if(m.toast.error("Error",{description:(null==(i=a.error.data)?void 0:i.detail)||"An error occurred"}),401===a.error.status)return e.push("/login?redirect=/getting-started")}if(r(h.MR.SEGMENTATION))return void e.push("/auth/post-login");let s=t.get("redirect");s&&(!s.startsWith("/")||s.startsWith("//")||s.includes("://"))&&(s="/"),e.replace(s||"/")};return(0,a.jsx)(eu,{dialogOpen:!0,onSettled:s})},em=()=>{let{authUser:e}=(0,o.Z2)(),{userData:t}=(0,c.ur)(),r=(0,o.Nm)(),m=(0,l.M)();(0,i.useRouter)();let p=(0,s.useRef)({}),f=(0,s.useRef)(!1),{trackLead:h}=(0,n.s)();return t&&!f.current&&(f.current=!0),(0,s.useEffect)(()=>{if((null==e?void 0:e.uid)&&m&&!p.current[e.uid]&&r){let t=(0,u.R)("dub_id");p.current[e.uid]=!0,m.identify(e.uid,{email:r,name:e.displayName}),m.track("registration_completed",{event_id:"Registration-".concat(e.uid)},{...(0,d.D)()}),t&&h({clickId:t,eventName:"Sign Up",customerExternalId:e.uid,customerName:e.displayName,customerEmail:r})}},[null==e?void 0:e.uid,m,r,null==e?void 0:e.displayName,h]),(0,a.jsx)("div",{className:"container mx-auto py-8",children:(0,a.jsx)(ed,{})})}},86344:e=>{e.exports=function(e,t){for(var r=-1,a=null==e?0:e.length,n=Array(a);++r<a;)n[r]=t(e[r],r,e);return n}},88201:e=>{e.exports=Array.isArray},89498:(e,t,r)=>{var a=r(53306),n=r(96420);e.exports=function(e){return null==e?[]:a(e,n(e))}},90936:(e,t,r)=>{"use strict";r.d(t,{x:()=>u});var a=r(95661),n=r(24500),i=r(63851),s=r(19620);let o="pending-promotion-code",l=()=>{try{let e,t=localStorage.getItem(o);if(!t)return null;try{e=JSON.parse(t)}catch(e){return s.logging.error("Failed to parse stored promotion code, clearing corrupted data",{error:e}),localStorage.removeItem(o),null}if(!e||!e.code||!e.timestamp)return s.logging.error("Invalid promotion code structure in storage, clearing",{parsed:e}),localStorage.removeItem(o),null;if(Date.now()-e.timestamp>12096e5)return localStorage.removeItem(o),null;return e}catch(e){return s.logging.error("Error retrieving stored promotion code",{error:e}),null}},c=async e=>{let t=(0,i.P)();await t.post("/user/stripe/pending-promotion-code",{promotion_code:e})},u=()=>{let e=(0,a.useCallback)(e=>{if(e&&""!==e.trim())try{l();let t={code:e.trim(),timestamp:Date.now()};localStorage.setItem(o,JSON.stringify(t))}catch(t){s.logging.error("Failed to store promotion code",{error:t,code:e})}},[]);return{storePromotionCode:e,applyStoredPromotionCode:(0,a.useCallback)(async()=>{let e=l();if(e){try{localStorage.removeItem(o)}catch(e){s.logging.error("Failed to remove stored promotion code",{error:e})}try{await c(e.code)}catch(t){if(t instanceof n.L&&t.status&&t.status>=400&&t.status<500);else{s.logging.error("Failed to apply pending promotion code, will retry on next login",{error:t});try{localStorage.setItem(o,JSON.stringify(e))}catch(e){s.logging.error("Failed to restore promotion code after error",{error:e})}}}}},[]),applyPromotionCode:(0,a.useCallback)(async e=>{try{await c(e)}catch(t){s.logging.error("Failed to apply promotion code",{error:t,code:e})}},[])}}},91632:(e,t,r)=>{var a=r(47188),n=r(81347);e.exports=function(e){if(!n(e))return!1;var t=a(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},92722:(e,t,r)=>{var a=r(22283),n=r(26181),i=r(88201);e.exports=function(e){return(i(e)?a:n)(e)}},94123:(e,t,r)=>{"use strict";r.d(t,{E:()=>c});var a=r(77145),n=r(40702),i=r(83220),s=r(61374),o=r(92918),l=r(15365);function c(e){var t;let{permission:r,featureFlags:c,plans:u,shouldShow:d=!0,adminOnly:m=!1,fallback:p=null,children:f}=e,h=(0,i.j4)(e=>e.currentWorkspace),{isAuthenticated:g}=(0,n.Z2)(),v=(0,l.WW)(),{permissions:y,isLoading:x}=(0,s.S)(),{featureFlags:b,featureFlagOverrides:j}=(0,o.Jp)(),w=!r||y.includes(r),k=null==(t=null==u?void 0:u.some(e=>{var t;return(null==h?void 0:h.plan)===e||(null==h||null==(t=h.plan)?void 0:t.startsWith(e))}))||t,N=!c||c.some(e=>{var t,r;return!!(null!=(r=null!=(t=j[e])?t:null==b?void 0:b[e])&&r)});return(!m||v)&&N&&d&&g&&!x?w&&k||v?(0,a.jsx)(a.Fragment,{children:f}):(0,a.jsx)(a.Fragment,{children:p}):null}},96420:(e,t,r)=>{var a=r(29753),n=r(47428),i=r(21166);e.exports=function(e){return i(e)?a(e):n(e)}}},e=>{e.O(0,[4197,5220,4397,5472,2247,624,2598,1410,6753,2670,8922,8352,5222,4718,3995,6419,4026,6415,9045,4041,9792,8038,7908,3279,9898,7739,9730,3851,5861,5200,7380,3161,7127,1689,7358],()=>e(e.s=16838)),_N_E=e.O()}]);